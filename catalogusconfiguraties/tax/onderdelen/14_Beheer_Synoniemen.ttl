#
#
#
# BEHEER Synoniemen
#
#
#


#Hoofdpagina Synoniemen Rapportage
stage:TaxHomoniemen2 a elmo:Representation;
	elmo:url-pattern "/query/synoniemen$";
	elmo:contains stage:TaxHeader;
	elmo:contains stage:TaxFooter;
	elmo:contains stage:TaxBeheermenu;
	elmo:contains stage:TaxSynoniemenTabel;
	elmo:contains stage:TaxSynoniemenUitleg;
.

stage:TaxSynoniemenUitleg a elmo:Part;
	elmo:appearance elmo:HtmlAppearance;
	elmo:index "1";
	elmo:without-parameter "term";
	elmo:data [
		rdfs:label "Synoniemen";
	]
.

# Weergave van Synoniemen
stage:TaxSynoniemenTabel a elmo:Part;
	elmo:appearance elmo:TableAppearance;
	elmo:index "2";
	elmo:query stage:TaxSynoniemenQuery;
	elmo:fragment [
		rdfs:label "Concept";						#de term die als homoniem voorkomt
		elmo:applies-to "conceptlabel";
		elmo:index "1";
	];
	elmo:fragment [
		rdfs:label "Populatie";						#het begrippenkader van het begrip
		elmo:applies-to "datasetlabel";
		elmo:index "2";
	];
	elmo:fragment [
		rdfs:label "Status";						#de status van het begrip
		elmo:applies-to "conceptstatuslabel";
		elmo:index "3";
	];
	elmo:fragment [
		rdfs:label "In";							#het begrippenkader van het 'andere' begrip (homoniem)
		elmo:applies-to "domeinlabel";
		elmo:index "5";
	];
	elmo:fragment [
		rdfs:label "Komt ook voor als";				#of het gaat om de term dan wel het synoniem van dat 'andere' begrip
		elmo:applies-to "synoniemlabel";
		elmo:index "4";
	];
	elmo:fragment [
		rdfs:label "Status";						#de status van synoniem
		elmo:applies-to "synoniemstatuslabel";
		elmo:index "6";
	];
.

stage:TaxSynoniemenQuery a elmo:query;
	elmo:query '''
		PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
		PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
		PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
		PREFIX doc: <http://localhost:8080/catalogus/tax/concepten/doc/>
		PREFIX prov: <http://www.w3.org/ns/prov#>
		PREFIX kddef: <http://kadaster.basisregistraties.overheid.nl/som/def#>
		PREFIX container: <http://localhost:8080/catalogus/tax/container/>
		SELECT DISTINCT ?conceptlabel ?conceptstatuslabel ?datasetlabel ?synoniemlabel ?domeinlabel  ?synoniemstatuslabel
		WHERE {
			GRAPH ?cg {
				?concept rdf:type skos:Concept.
				?concept rdfs:label ?conceptlabel.	
				?concept skos:altLabel ?synoniem.
				?concept kddef:status ?conceptstatus.
			}
			GRAPH ?dsg {
				?dataset rdfs:label ?datasetlabel.
				?domein rdfs:label ?domeinlabel.
			}
			OPTIONAL {
				GRAPH container:statusupload {
					?conceptstatus rdfs:label ?conceptstatuslabel.
					?synoniemstatus rdfs:label ?synoniemstatuslabel.
					FILTER (lang(?conceptstatuslabel)="" || lang(?conceptstatuslabel)="nl")
					FILTER (lang(?synoniemstatuslabel)="" || lang(?synoniemstatuslabel)="nl")
				}
			}
			FILTER( LANG( ?conceptlabel ) = "" || LANGMATCHES( LANG( ?conceptlabel ), "nl" ) )
			GRAPH doc:mastergraph {
				?concept rdfs:isDefinedBy ?cg.
				?dataset rdfs:isDefinedBy ?dsg.
				?domein rdfs:isDefinedBy ?dsg.
				?concept skos:inScheme ?dataset.
			}
		}
	ORDER BY ?conceptlabel
	'''
.